<div class="stepper-container" [ngClass]="'layout-' + layout">
  
  <!-- Chapter Title (for 'full' layout) -->
  <div *ngIf="layout === 'full' && showChapterTitle" class="chapter-title">
    Chapters
  </div>

  <!-- Steps List -->
  <div class="steps-list" [class.collapsed]="collapsed">
    
    <div *ngFor="let step of steps" 
         class="step-wrapper"
         [ngClass]="'state-' + step.state"
         (click)="onStepClick(step)">
      
      <!-- Content -->
      <div class="step-content">
        
        <!-- Step Number Circle -->
        <div class="step-number">
          <span class="number-text">{{ step.number }}</span>
        </div>

        <!-- Step Title (shown in 'with-titles' and 'full' layouts, hidden when collapsed) -->
        <div *ngIf="layout !== 'numbers-only' && !collapsed" class="step-info">
          <div class="step-title">{{ step.title }}</div>
          <div *ngIf="step.subtitle" class="step-subtitle">{{ step.subtitle }}</div>
        </div>

      </div>
    </div>

    <!-- Collapse Button -->
    <div class="collapse-wrapper" (click)="toggleCollapse()">
      <div class="collapse-content">
        <!-- Chevron Right Icon (when collapsed) -->
        <svg *ngIf="collapsed" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M5.22672 16.1482C5.17434 16.096 5.13278 16.0339 5.10442 15.9656C5.07606 15.8972 5.06147 15.824 5.06147 15.75C5.06147 15.676 5.07606 15.6027 5.10442 15.5344C5.13278 15.466 5.17434 15.404 5.22672 15.3517L11.5796 8.99997L5.22672 2.64822C5.1211 2.5426 5.06176 2.39935 5.06176 2.24997C5.06176 2.1006 5.1211 1.95734 5.22672 1.85172C5.33234 1.7461 5.4756 1.68676 5.62497 1.68676C5.77435 1.68676 5.9176 1.7461 6.02322 1.85172L12.7732 8.60172C12.8256 8.65397 12.8672 8.71605 12.8955 8.78439C12.9239 8.85272 12.9385 8.92598 12.9385 8.99997C12.9385 9.07396 12.9239 9.14722 12.8955 9.21556C12.8672 9.2839 12.8256 9.34597 12.7732 9.39822L6.02322 16.1482C5.97097 16.2006 5.9089 16.2422 5.84056 16.2705C5.77222 16.2989 5.69896 16.3135 5.62497 16.3135C5.55098 16.3135 5.47772 16.2989 5.40938 16.2705C5.34105 16.2422 5.27897 16.2006 5.22672 16.1482Z" fill="#1C4240"/>
        </svg>
        
        <!-- Chevron Left Icon (when expanded) -->
        <svg *ngIf="!collapsed" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M12.7733 1.85178C12.8257 1.90403 12.8672 1.9661 12.8956 2.03444C12.9239 2.10278 12.9385 2.17604 12.9385 2.25003C12.9385 2.32402 12.9239 2.39728 12.8956 2.46562C12.8672 2.53396 12.8257 2.59603 12.7733 2.64828L6.4204 9.00003L12.7733 15.3518C12.8789 15.4574 12.9382 15.6007 12.9382 15.75C12.9382 15.8994 12.8789 16.0427 12.7733 16.1483C12.6677 16.2539 12.5244 16.3132 12.375 16.3132C12.2257 16.3132 12.0824 16.2539 11.9768 16.1483L5.22678 9.39828C5.17439 9.34603 5.13283 9.28395 5.10448 9.21562C5.07612 9.14728 5.06152 9.07402 5.06152 9.00003C5.06152 8.92604 5.07612 8.85278 5.10448 8.78444C5.13283 8.7161 5.17439 8.65403 5.22678 8.60178L11.9768 1.85178C12.029 1.7994 12.0911 1.75783 12.1594 1.72948C12.2278 1.70112 12.301 1.68652 12.375 1.68652C12.449 1.68652 12.5223 1.70112 12.5906 1.72948C12.659 1.75783 12.721 1.7994 12.7733 1.85178Z" fill="#1C4240"/>
        </svg>
        
        <span *ngIf="!collapsed" class="collapse-text">Collapse</span>
      </div>
    </div>

  </div>

</div>